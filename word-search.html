<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Word Search Puzzle</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      text-align: center;
    }
    #loading {
      font-size: 1.5em;
      margin-top: 2em;
    }
    #puzzle-container {
      display: none;
      margin: 20px auto;
    }
    table {
      border-collapse: collapse;
      margin: 0 auto;
    }
    td {
      border: 1px solid #000;
      width: 30px;
      height: 30px;
      text-align: center;
      vertical-align: middle;
      font-size: 20px;
      cursor: default;
    }
    #word-list {
      margin-top: 20px;
      list-style-type: none;
      padding: 0;
    }
  </style>
</head>
<body>
  <h1>Word Search Puzzle</h1>
  <div id="loading">Generating puzzle, please wait...</div>
  <div id="puzzle-container">
    <table id="puzzle"></table>
    <h3>Words to Find:</h3>
    <ul id="word-list"></ul>
  </div>

  <script>
    const words = ["QUANTUM", "PROTON", "ENERGY", "BEAM", "TARGET", "MAGNET", "VACUUM", "ACCELERATOR", "CERN", "PARTICLE"];
    const gridSize = 15;
    const grid = Array.from({ length: gridSize }, () => Array(gridSize).fill(''));
    const directions = [
      { x: 1, y: 0 },   // right
      { x: 0, y: 1 },   // down
      { x: 1, y: 1 },   // down-right
      { x: -1, y: 0 },  // left
      { x: 0, y: -1 },  // up
      { x: -1, y: -1 }, // up-left
      { x: 1, y: -1 },  // up-right
      { x: -1, y: 1 }   // down-left
    ];

    function placeWords() {
      const sortedWords = [...words].sort((a, b) => b.length - a.length);

      for (let word of sortedWords) {
        word = word.toUpperCase();
        let placed = false;
        let attempts = 0;
        const maxAttempts = 500;

        while (!placed && attempts < maxAttempts) {
          attempts++;
          const dir = directions[Math.floor(Math.random() * directions.length)];
          const row = Math.floor(Math.random() * gridSize);
          const col = Math.floor(Math.random() * gridSize);
          let fits = true;

          for (let i = 0; i < word.length; i++) {
            const newRow = row + dir.y * i;
            const newCol = col + dir.x * i;
            if (
              newRow < 0 || newRow >= gridSize ||
              newCol < 0 || newCol >= gridSize ||
              (grid[newRow][newCol] !== '' && grid[newRow][newCol] !== word[i])
            ) {
              fits = false;
              break;
            }
          }

          if (fits) {
            for (let i = 0; i < word.length; i++) {
              const newRow = row + dir.y * i;
              const newCol = col + dir.x * i;
              grid[newRow][newCol] = word[i];
            }
            placed = true;
          }
        }

        if (!placed) {
          console.warn(`Could not place word: ${word}`);
        }
      }
    }

    function fillEmptySpaces() {
      const letters = "ABCDEFGHIJKLMNOPQRSTUVWXYZ";
      for (let row = 0; row < gridSize; row++) {
        for (let col = 0; col < gridSize; col++) {
          if (grid[row][col] === '') {
            grid[row][col] = letters[Math.floor(Math.random() * letters.length)];
          }
        }
      }
    }

    function drawGrid() {
      const table = document.getElementById("puzzle");
      table.innerHTML = "";
      for (let row = 0; row < gridSize; row++) {
        const tr = document.createElement("tr");
        for (let col = 0; col < gridSize; col++) {
          const td = document.createElement("td");
          td.textContent = grid[row][col];
          tr.appendChild(td);
        }
        table.appendChild(tr);
      }
    }

    function showWordList() {
      const list = document.getElementById("word-list");
      for (let word of words) {
        const li = document.createElement("li");
        li.textContent = word.toUpperCase();
        list.appendChild(li);
      }
    }

    function generatePuzzle() {
      placeWords();
      fillEmptySpaces();
      drawGrid();
      showWordList();
      document.getElementById("loading").style.display = "none";
      document.getElementById("puzzle-container").style.display = "block";
    }

    // Slight delay to let page render loading text before JS starts
    setTimeout(generatePuzzle, 50);
  </script>
</body>
</html>
