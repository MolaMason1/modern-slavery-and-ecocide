<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Word Search â€“ Modern Slavery & Ecocide</title>
  <link rel="stylesheet" href="styles.css" />
  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: #e9f7e6;
      color: #2d6a4f;
      margin: 0;
      padding: 0;
    }

    header {
      background-color: #2d6a4f;
      color: white;
      text-align: center;
      padding: 20px;
    }

    h1 {
      margin: 0;
    }

    .container {
      max-width: 1000px;
      margin: 30px auto;
      padding: 20px;
      background-color: white;
      border-radius: 8px;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }

    .word-list {
      margin-top: 20px;
      font-size: 1.1em;
    }

    .word-list ul {
      list-style: none;
      padding-left: 0;
      columns: 2;
    }

    .word-list li {
      margin: 5px 0;
      cursor: pointer;
    }

    .word-list li.found {
      text-decoration: line-through;
      color: gray;
    }

    .word-search-grid {
      margin-top: 30px;
      display: grid;
      grid-template-columns: repeat(15, 1fr);
      gap: 4px;
      justify-content: center;
      touch-action: manipulation;
    }

    .cell {
      aspect-ratio: 1;
      font-size: 1em;
      text-transform: uppercase;
      border: 1px solid #ccc;
      border-radius: 4px;
      user-select: none;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .cell.selected {
      background-color: #a3d9a5;
    }

    .cell.found {
      background-color: #38b000;
      color: white;
    }

    .instructions {
      margin-top: 20px;
      font-size: 1em;
    }

    .back-link {
      display: inline-block;
      margin-top: 30px;
      text-decoration: none;
      color: #2d6a4f;
      font-weight: bold;
    }

    .back-link:hover {
      text-decoration: underline;
    }

    @media (max-width: 600px) {
      .word-search-grid {
        grid-template-columns: repeat(15, minmax(18px, 1fr));
      }

      .container {
        padding: 10px;
      }
    }
  </style>
</head>
<body>
  <header>
    <h1>Word Search</h1>
  </header>

  <div class="container">
    <p class="instructions">
      Tap or click on letters to select them. Once you have selected a full word, press Enter (or tap the "Submit" button on mobile) to check.
    </p>

    <div class="word-list">
      <h3>Word List</h3>
      <ul id="wordList">
        <li>Ecocide</li>
        <li>Slavery</li>
        <li>Extraction</li>
        <li>Export</li>
        <li>Manufacture</li>
        <li>Retail</li>
        <li>Consumer</li>
        <li>Kevin Bales</li>
        <li>Deforestation</li>
        <li>Pollution</li>
        <li>Trafficking</li>
        <li>Corruption</li>
        <li>Supply Chain</li>
        <li>Mining</li>
        <li>Logging</li>
        <li>Debt</li>
        <li>Freedom</li>
      </ul>
    </div>

    <div class="word-search-grid" id="grid"></div>

    <button id="submitBtn" style="margin-top: 20px; display: block;">Submit Selection</button>

    <a href="index.html" class="back-link">&larr; Back to Home</a>
  </div>

  <script>
    const words = [
      "ecocide", "slavery", "extraction", "export", "manufacture", "retail",
      "consumer", "kevinbales", "deforestation", "pollution",
      "trafficking", "corruption", "supplychain", "mining", "logging", "debt", "freedom"
    ];

    const gridSize = 15;
    const grid = [];
    const directions = [
      { x: 1, y: 0 }, { x: 0, y: 1 }, { x: 1, y: 1 },
      { x: -1, y: 0 }, { x: 0, y: -1 }, { x: -1, y: -1 },
      { x: 1, y: -1 }, { x: -1, y: 1 }
    ];

    for (let i = 0; i < gridSize; i++) {
      grid[i] = [];
      for (let j = 0; j < gridSize; j++) {
        grid[i][j] = '';
      }
    }

    function placeWords() {
      words.sort((a, b) => b.length - a.length);

      for (let word of words) {
        word = word.toUpperCase();
        let placed = false;
        while (!placed) {
          const dir = directions[Math.floor(Math.random() * directions.length)];
          const row = Math.floor(Math.random() * gridSize);
          const col = Math.floor(Math.random() * gridSize);
          let fits = true;

          for (let i = 0; i < word.length; i++) {
            const newRow = row + dir.y * i;
            const newCol = col + dir.x * i;
            if (
              newRow < 0 || newRow >= gridSize ||
              newCol < 0 || newCol >= gridSize ||
              (grid[newRow][newCol] !== '' && grid[newRow][newCol] !== word[i])
            ) {
              fits = false;
              break;
            }
          }

          if (fits) {
            for (let i = 0; i < word.length; i++) {
              const newRow = row + dir.y * i;
              const newCol = col + dir.x * i;
              grid[newRow][newCol] = word[i];
            }
            placed = true;
          }
        }
      }
    }

    function fillGrid() {
      const letters = "ABCDEFGHIJKLMNOPQRSTUVWXYZ";
      for (let i = 0; i < gridSize; i++) {
        for (let j = 0; j < gridSize; j++) {
          if (grid[i][j] === '') {
            grid[i][j] = letters[Math.floor(Math.random() * letters.length)];
          }
        }
      }
    }

    function renderGrid() {
      const gridContainer = document.getElementById('grid');
      gridContainer.innerHTML = '';
      for (let i = 0; i < gridSize; i++) {
        for (let j = 0; j < gridSize; j++) {
          const cell = document.createElement('div');
          cell.classList.add('cell');
          cell.dataset.row = i;
          cell.dataset.col = j;
          cell.textContent = grid[i][j];
          gridContainer.appendChild(cell);
        }
      }
    }

    let selectedCells = [];

    function toggleCell(cell) {
      if (cell.classList.contains('selected')) {
        cell.classList.remove('selected');
        selectedCells = selectedCells.filter(c => c !== cell);
      } else {
        cell.classList.add('selected');
        selectedCells.push(cell);
      }
    }

    function clearSelection() {
      selectedCells.forEach(cell => cell.classList.remove('selected'));
      selectedCells = [];
    }

    function checkWord() {
      const selectedWord = selectedCells.map(cell => cell.textContent).join('').toLowerCase();
      const reversedWord = selectedCells.map(cell => cell.textContent).reverse().join('').toLowerCase();
      const wordListItems = document.querySelectorAll('#wordList li');

      for (let item of wordListItems) {
        const word = item.textContent.replace(/\s+/g, '').toLowerCase();
        if (selectedWord === word || reversedWord === word) {
          selectedCells.forEach(cell => cell.classList.add('found'));
          item.classList.add('found');
          break;
        }
      }
      clearSelection();
    }

    document.addEventListener('click', (e) => {
      if (e.target.classList.contains('cell')) {
        toggleCell(e.target);
      }
    });

    document.addEventListener('keydown', (e) => {
      if (e.key === 'Enter') {
        checkWord();
      }
    });

    document.getElementById('submitBtn').addEventListener('click', checkWord);

    placeWords();
    fillGrid();
    renderGrid();
  </script>
</body>
</html>
